(function(i,P){typeof exports=="object"&&typeof module<"u"?P(exports,require("@lifespikes/cogent-ts"),require("@inertiajs/react")):typeof define=="function"&&define.amd?define(["exports","@lifespikes/cogent-ts","@inertiajs/react"],P):(i=typeof globalThis<"u"?globalThis:i||self,P((i.Inertia=i.Inertia||{},i.Inertia["js Table React with the power of Laravel Query Builder"]={}),i.cogentTs,i.InertiaReact))})(this,function(i,P,$){"use strict";function E(t,r){return Object.fromEntries(Object.entries(t).filter(([e])=>r(e)))}function S(t,r){return E(t,e=>!r.includes(e))}function T(t,r){const e={...t};return Object.keys(e).length===0||r.forEach(o=>{const a=o.split("."),f=a.pop();if(!f)return;const s=a.reduce((u,c)=>u[c],e);s&&delete s[f]}),e}function w(t,r="default"){return r==="default"?t:`${r}_${t}`}const B=(t,r="")=>Object.entries(t).flatMap(([e,o])=>typeof o=="object"&&o!==null?r?B(o,`${r}[${e}]`):B(o,`${e}`):r?[`${r}[${e}]=${o}`]:[`${e}=${o}`]);function C(t){const r=new URLSearchParams(t||window.location.search),e={};for(const[o,a]of r.entries()){const f=o.split("[").map(u=>u.endsWith("]")?u.slice(0,-1):u);let s=e;for(let u=0;u<f.length;u++){const c=f[u];s[c]||(u===f.length-1?s[c]=a:s[c]={}),s=s[c]}}return e}function K(){const t=C(),r=(o,a=void 0)=>t[o]||a,e=window.location.origin+window.location.pathname;return{getParam:r,params:t,currentPath:e}}function R(t){const{tableName:r="default",queryKey:e,filters:o}=t||{},{params:a,currentPath:f}=K(),s=e||w("filter",r),u=e||w("page",r),O=P.queryBuilder({baseUrl:f})(),b=n=>T({...a},[...n,t!=null&&t.ignorePagination?u:""]),q=(n,l)=>{let d=b([`${s}.${n}`]);l&&(d={...a,[`${s}[${n}]`]:l}),p(d)},F=(n,l)=>{const d=Object.keys(n).map(g=>`${s}.${g}`);let j=b([...d,...l?l.map(g=>`${s}.${g}`):[]]);d.length&&(j=Object.entries(n).reduce((g,[L,M])=>M?{...g,[`${s}[${L}]`]:M}:g,j)),p(j)},h=(n,l)=>{let d=b([`${s}.${n==null?void 0:n.name}`]);l&&(d={...d,[`${s}[${n==null?void 0:n.name}]`]:l}),p(d)},k=(n,l)=>{const d=o==null?void 0:o.find(j=>j.name===n);if(!d)throw new Error(`Filter with name ${n} not found`);h(d,l)},v=n=>{const l={...T(a,[`${s}.${n.name}`])};p(l)},m=()=>{const n=S(a,[s]);p(n)},y=n=>{var l;return(l=a[s])==null?void 0:l[n]},p=n=>{$.router.visit(O.params(n).get(),{method:"get",preserveState:!0})};return{onFilter:h,onFilterByName:q,onMultiFilterByObject:F,onFilterFor:k,filterValue:y,removeFilter:v,clearFilters:m}}function I(t){const{tableProps:r}=$.usePage().props;return r[t]}function U({tableName:t,queryKey:r,column:e}){const o=r||w("sort",t),a=I(t),{params:f,currentPath:s}=K(),c=P.queryBuilder({baseUrl:s,queryParams:{sort:o}})(),O=a.sort,b=S(f,[o]),q=m=>{c.sort([m.name])},F=m=>{c.sort([`-${m.name}`])},h=()=>{c.sort([])};return{onSortBy:m=>{const y=m||e;if(!y)throw new Error("Column is required");Object.keys(b).length>0&&c.params(b),O===y.name?F(y):O===`-${y.name}`?h():q(y),$.router.visit(c.get(),{method:"get"})},onSort:(m="desc")=>{if(!e)throw new Error("Column is required");Object.keys(b).length>0&&c.params(b),m==="asc"&&e.sorted!=="asc"?q(e):m==="desc"&&e.sorted!=="desc"?F(e):h(),$.router.visit(c.get(),{method:"get"})}}}function V({name:t="default",resource:r}){const e=$.usePage().props,o=r?e[r]:e[t],a=e.tableProps[t];if(!a)throw new Error(`Table ${t} does not exist`);const f=s=>{var u;return((u=a.columns.find(c=>c.name===s))==null?void 0:u.hidden)??!1};return{tableName:t,tableProps:{name:t,...a,...o},isHiddenColumn:f}}i.filterObject=E,i.flattenKeyValueParams=B,i.getParamsObject=C,i.omit=S,i.omitNotation=T,i.queryKeyFor=w,i.useFiltering=R,i.useParams=K,i.useSorting=U,i.useTable=V,i.useTableProps=I,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
